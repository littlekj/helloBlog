{% extends 'base.html' %}
{% load static %}

{% block content %}
  <article class="px-1">
    <header>
      <!-- 文章标题 -->
      <h1 data-toc-skip>{{ post.title }}</h1>

      {% if post.excerpt %}
        <!-- 文章描述 -->
        <p class="post-desc fw-light mb-4"></p>
      {% endif %}

      <div class="post-meta text-muted">
        <!-- 发布时间 -->
<!--        <span>-->
<!--          {{ "发布：" }}-->
<!--          {% include "_includes/datetime.html" with post_time=post.created_time tooltip=true lang="en" %}-->
<!--        </span>-->

        <!-- 最后修改时间 -->
        <span>
        {{ "发布：" }}
        {% if post.modified_time %}
        <time data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="">
            <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{{ post.modified_time|date:'Y/m/d' }}</font></font>
        </time>
        {% else %}
        <time data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="">
            <font style="vertical-align: inherit;"><font style="vertical-align: inherit;">{{ post.created_time|date:'Y/m/d' }}</font></font>
        </time>
        {% endif %}
        </span>

        {% if post.image %}
          <!-- 文章图片 -->
          <div class="mt-3 mb-3">
            <img src="{{ post.image.path }}" class="preview-img{% if not post.image.no_bg %} no-bg{% endif %}"
                 alt="{{ post.image.alt }}" width="1200" height="630" {% if post.image.lqip %}lqip="{{ post.image.lqip }}"{% endif %}>
            {% if post.image.alt %}
              <figcaption class="text-center pt-2 pb-2">{{ post.image.alt }}</figcaption>
            {% endif %}
          </div>
        {% endif %}

<!--        <div class="d-flex justify-content-between">-->
          <!-- 作者信息 -->
          {% if post.author %}
            <span>
              作者：
              <em>
                  <a href="#">{{ post.author }}</a>
              </em>
            </span>
          {% endif %}

<!--          <div>-->
            <!-- 页面浏览量 -->
            {% if not post.views %}
              <span>
                <em id="pageviews">
                  <i class="fas fa-spinner fa-spin small"></i>
                </em>
                 浏览量：{{ post.views }}
              </span>
            {% endif %}

            <!-- 阅读时长 -->
            {% include "_includes/read-time.html" with content=post.body prompt=true %}
<!--          </div>-->
<!--        </div>-->
      </div>
    </header>

    <div class="content">
      {{ post.body|safe }}
    </div>

    <div class="post-tail-wrapper text-muted">
      <!-- 文章分类 -->
      {% if post.categories.all %}
        <div class="post-meta mb-3">
          <i class="far fa-folder-open fa-fw me-1"></i>
          {% for category in post.categories.all %}
            <a href="{{ category.get_absolute_url }}">{{ category.name }}</a>
            {% if not forloop.last %}, {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      <!-- 文章标签 -->
      {% if post.tags.all %}
        <div class="post-tags">
          <i class="fa fa-tags fa-fw me-1"></i>
          {% for tag in post.tags.all %}
            <a href="{% url 'blog:tag_detail' slug=tag.slug %}" class="post-tag no-text-decoration">
              {{ tag.name }}
            </a>
          {% endfor %}
        </div>
      {% endif %}

      <div class="post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2">
        <div class="license-wrapper">
            本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/">{{"CC BY 4.0"}}</a> 进行授权。
        </div>
        {% include "_includes/post-sharing.html" %}
      </div>
    </div>
  </article>
{% endblock %}

{% block toc %}
  {% include "_includes/toc.html" with post=post %}
{% endblock %}

{% block comments %}
  {% include '_includes/comments.html' %}
{% endblock %}

